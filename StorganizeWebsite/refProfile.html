<!DOCTYPE html>
<html>
<title>Storganize Advocate</title>
<head>
	<!-- Bringing in Firebase -->
		
			<script src="https://www.gstatic.com/firebasejs/3.6.10/firebase.js"></script>
			<script>
			  // Initialize Firebase
			  var config = {
			    apiKey: "AIzaSyCWbr-clEQJaLg_CoUcOR7hMRrPrx46qI0",
			    authDomain: "storganize-referral.firebaseapp.com",
			    databaseURL: "https://storganize-referral.firebaseio.com",
			    storageBucket: "storganize-referral.appspot.com",
			    messagingSenderId: "314957063559"
			  };
			  firebase.initializeApp(config);
			</script>

		<!-- Bringing in jQuery -->
		<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.js"></script>

		<!-- Bringing in Materialize via CDN -->
				<!-- Compiled and minified CSS -->
		  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css">
		  	<!-- Compiled and minified CSS -->
		  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

		  	<!-- Compiled and minified JavaScript -->
		  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script>

		<!-- Bringing in copy to clipboard functionality-->
		  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>


</head>

<body class="#fafafa grey lighten-5">
<div style="text-align: center;">
<a class="waves-effect waves-light btn-large" id="openRegLoginForm">
				          Apply
				      </a>
</div>
	<!-- All HTML for signup and profile is below -->

	
    
	
<div id="registerForm" class="modal">
<div class="modal-content">
	<!-- Register / Login Page Header -->
	<div class="container">
		<h1 class="header center orange-text">Storganize Advocate Portal</h1>
				  

		<!-- Register Form-->

		<div class="card-panel">
		    <form class="container" id="registerForm">
		    	<div class="row">
		        	<div class="input-field">
		        		<input id="firstName" type="text" class="validate" required>
			          <label data-error="Please enter a value.">First Name</label>
		        	</div>
	      	  </div>
	      	<div class="row">
		        	<div class="input-field">
		        		<input id="lastName" type="text" class="validate" required>
			          <label>Last Name</label>
		        	</div>
	      	  </div>
	      	<div class="row">
		        	<div class="input-field">
		        		<input id="orgName" type="text" class="validate">
			          <label>Organization Name (if applicable)</label>
		        	</div>
	      	  </div>
		    	<div class="row">
		        	<div class="input-field">
		        		<input id="regEmail" type="email" class="validate" required>
			          <label for="email">Email</label>
		        	</div>
	      	  </div>
	      	 	<div class="row">
		        	<div class="input-field">
			          <input id="regPassword" type="password" class="validate" required>
			          <label for="password">Create Password</label>
		        	</div>
	      	  	</div>
	      	  <div id="errorMessage"></div>
		        <div class="row">
				      <a class=" waves-effect waves-light btn-large" id="register">
				          Register
				      </a>
		      	</div>
		    </form>
</div>
</div>
</div>
</div>

	
			     
		

		<!-- All Javascript logic is contained within the below script tag for easy embed on Squarespace. When we transition to Storganize App, this code should be placed within a standard index.js file-->

		<script type="text/Javascript">	

		// Event Listeners
		document.getElementById("register").addEventListener("click", handleRegister);
		document.getElementById("openRegLoginForm").addEventListener("click", displayModal);
		
		// View Controllers
		function displayProfile() {	
				window.location="https://www.storganize.io/test-advocate-profile";
			  window.scrollTo(0,0)
		};

		function displayModal() {
			$("#registerForm").modal('open');
		}

		
		// Regsitration and Login Logic
		function handleRegister() {
			var email = document.getElementById("regEmail").value;
			var password = document.getElementById("regPassword").value;
			var firstName = document.getElementById("firstName").value;
			var lastName = document.getElementById("lastName").value;
			var orgName = document.getElementById("orgName").value;

				 if (firstName == "") {
				 				document.getElementById('errorMessage').innerHTML = "<span style='color: red;'>" + "First name is required" + "</span>";     
					    } else if (lastName == "") {
					    	document.getElementById('errorMessage').innerHTML = "<span style='color: red;'>" + "Last name is required" + "</span>"
					    } else {

								firebase.auth().createUserWithEmailAndPassword(email, password).then(function() {
										var user = firebase.auth().currentUser
						            var uid = user.uid
						            firebase.database().ref('referrers/' + user.uid).set({
						                  email: email,
						                  firstName: firstName,
						                  lastName: lastName,
						                  orgName: orgName,
						                  refCandyCode: ''
							        })
								  	displayProfile();
									}, function(error){
										document.getElementById('errorMessage').innerHTML = "<span style='color: red;'>" + error.message + "</span>"
									})
							}
			};

	$(document).ready(function(){
    // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
    $('.modal').modal();
  })
		
		</script>


</body>

</html>